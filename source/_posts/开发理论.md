---
title: 开发理论
---

# 软件开发 7 原则

## 参考文章

[软件开发的7个原则](https://blog.csdn.net/qq_42145271/article/details/105605973)

## 面向对象的基本原则：SOLID

- 单一职责原则 Single Responsibility Principle\
一个类，最好只做一件事，只有一个导致它变化的原因。
- 开闭原则 Open-Closed Principle\
对扩展开放，对修改关闭。
- 里氏替换原则 Liskov Substitution Principle\
一个软件实体如果适用于一个父类，那么一定适用于其子类。所有引用父类的地方必须能透明地使用其子类的对象，子类对象能够替换父类对象，而程序逻辑不变。
- 接口隔离原则 Interface Segregation Principle\
使用多个隔离的接口，比使用单个接口要好。降低类之间的耦合度。建立单一接口，不要建立庞大臃肿的接口，尽量细化接口，接口中的方法尽量少。
- 依赖倒置原则 Dependence Inversion Principle\
针对接口编程，不要针对实现编程。高层模块不应该依赖低层模块，二者都应该依赖其抽象。抽象不应该依赖细节，细节应该依赖抽象。

## 其他原则

- 迪米特法则 Law of Demeter\
又叫最少知道原则（Least Knowledge Principle）。系统中的类，尽量不要与其他类互相作用，尽量降低类之间的耦合度。
- 组合/聚合复用原则 Composite/Aggregate Reuse Principle\
要尽量使用对象组合，而不是继承关系达到软件复用的目的。

# 分布式理论：CAP

## 参考文章

[拜托！这才是分布式系统CAP的正确打开方式！](https://baijiahao.baidu.com/s?id=1675967348764896309&wfr=spider&for=pc)

[分布式之CAP原则详解](https://blog.csdn.net/lixinkuan328/article/details/95535691)

## 说明

- 一致性 Consistency\
在分布式系统中的所有数据备份，在同一时刻具备相同的值，即强一致性。
- 可用性 Availability\
对数据更新具备高可用性。集群整体能够及时响应请求，即使部分节点出现故障。
- 分区容错性 Partition tolerance\
能容忍网络分区。出现网络分区的情况下，系统仍能正常对外提供服务。
   > 通常情况下，网络分区指的是在分布式集群中，节点之间由于网络不通，导致集群中节点形成不同的子集，子集中节点间的网络相通，而子集和子集间网络不通。网络分区是子集与子集之间在网络上相互隔离了。

## 选择

### 三选二

假设两个副本处于两个网络分区中：

- 如果允许其中一个副本更新，则会导致数据不一致，即丧失了 C 性质
- 如果为了保证一致性，将副本设置为不可变更，那么又丧失了 A 性质
- 除非两个副本可以互相通信，才能既保证 C 又保证 A ，这又会导致丧失 P 性质

一般来说使用网络通信的分布式系统，无法舍弃 P 性质，那么就只能在一致性和可用性上做一个艰难的选择。

### 权衡

一致性和可用性不是完全互斥的：

- 由于分区很少发生，那么在系统不存在分区的情况下没什么理由牺牲 C 或 A
- C 与 A 之间的取舍可以在同一系统内以非常细小的粒度反复发生，而每一次的决策可能因为具体的操作，乃至因为牵涉到特定的数据或用户而有所不同
- 这三种性质都可以在程度上衡量，并不是非黑即白的有或无。可用性显然是在 0% 到 100% 之间连续变化的，一致性分很多级别，连分区也可以细分为不同含义，如系统内的不同部分对于是否存在分区可以有不一样的认知

## 解决方案

### BASE原则

BASE 原则是对 AP 选型的补充。

核心思想：即使无法做到强一致性（Strong consistency），但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性（Eventual consistency）。

- [A]基本可用 Basically Available\
分布式系统在出现不可预知故障的时候，允许损失部分可用性（但不能变为不可用）。如：
   - 响应时间增加
   - 功能熔断降级
- [C]软状态 Soft State\
允许分布式系统中的数据存在一个中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即允许系统在不同节点的数据副本之间进行数据同步的过程存在延时。比如 Kafka 的 partition 多个 replica 之间并不是一直同步的。
- [C]最终一致性 Eventual Consistency\
系统中所有的数据副本，在经过一段时间的同步后，最终能够达到一个一致的状态。

### ACID

事务的 ACID 特性是对 CA 选型的补充。

- 原子性 Atomicity\
事务被视为不可分割的最小单元，事务的所有操作要么全部提交成功，要么全部失败回滚。
   > 回滚可以用日志来实现，日志记录着事务所执行的修改操作，在回滚时反向执行这些修改操作即可。
- 一致性 Consistency\
事务必须使数据库从一个一致性状态变到另一个一致性状态，事务的中间状态不能被观察到。
- 隔离性 Isolation\
一个事务所做的修改在最终提交以前，对其它事务是不可见的。
- 持久性 Durability\
一旦事务提交，则其所做的修改将会永远保存到数据库中。即使系统发生崩溃，事务执行的结果也不能丢失。
   > 可以通过数据库备份和恢复来实现，在系统发生崩溃时，使用备份的数据库进行数据恢复。

<style type="text/css">* {font-family: YaHei Consolas Hybrid, Consolas;}</style>